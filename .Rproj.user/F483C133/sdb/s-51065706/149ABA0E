{
    "collab_server" : "",
    "contents" : "#Generalized Implementation of Propensity Matching, CT, RF, and MatchIt Linear Models\n#Inputs: \n  #Required:\n    #Dataset\n    #List of Control Variables\n    #Single Outcome Variable\n    #Single Treatment Variable\n    #Folder for output\n    #Prefix for file outputs\n  #Optional: \n    #four key variables for balance plotting (list)\n    #title.desc - description for titles in outputs\n    #geog.fields = alternative columns for latitude and longitude.\n\n#Outputs:\n  #Stargazer table of descriptive statistics (prefix_desc.html)\n  #Map of all locations (prefix_map.png)\n  #Pre-balance plot - propensity score and four key variables (first four in list taken otherwise; prefix_prebalance.html)\n  #Stargazer table for propensity linear model (prefix_propensityModel.html)\n  #Post-balance plot - propensity score and four key variables (first four in list taken otherwise; prefix_postbalance.html)\n  #Stargazer table of balance statistics (prefix_balancestats.html)\n  #Causal Tree results (prefix_ct.png)\n  #Stargazer of linear model using matched cases and interactions identified in Causal Tree (prefix_geoMath.html)\n  #Map of predicted results from Causal Tree (prefix_prediction.png)\n  #CSV of predicted results from Causal Tree (prefix_prediction.csv)\n  #Random Forest results (prefix_rf.csv)\n  #Figure of most important variables in RF (prefix_purity.png)\n  #Map of uncertainty (\"% of observations within 1 standard deviation of the mean\") from RF (prefix_rfUnc.png)\n  \n#Libraries\nlibrary(sp)\nlibrary(ggplot2)\nlibrary(rgdal)\n#library(spatstat)\n#library(maptools)\n#library(rgeos)\n#library(geojsonio)\nlibrary(MatchIt)\nlibrary(rpart)\nlibrary(Rcpp)\nlibrary(stargazer)\n#library(doBy)\nsourceCpp(\"/home/aiddata/Desktop/Github/GEF_MFA/Analyses/split.cpp\")\n\ngeoSuite <- function(dta, trt, ctrl, outcome, pth, file.prefix, kvar, title.desc = \"\", geog.fields = c(\"latitude\", \"longitude\"))\n{\n  #Truncate to relevant variables\n  cvar.lim <- ceiling(length(ctrl) / 2)\n  ctrl.vars <- ctrl[1:cvar.lim]\n  ctrl.names <- ctrl[(ceiling(length(ctrl) / 2)+1):length(ctrl)]\n  \n  sub.dta <- dta[c(ctrl.vars, trt[1], outcome[1])]\n  \n  labels <- c(ctrl.names, trt[2], outcome[2])\n  \n  #Stargazer table of descriptive statistics (prefix_desc.html)\n  stargazer(sub.dta, \n                  type=\"html\", \n                  median=TRUE, \n                  digits=2, \n                  title=paste(\"Descriptive Statistics:\",title.desc),\n                  covariate.labels = labels,\n                  out = paste(pth,file.prefix,\"_desc.html\",sep=\"\")\n           )\n  \n  \n  #Map of all locations (prefix_map.png)\n  \n  lonlat <- sub.dta[,c(geog.fields[2], geog.fields[1])]\n  spdf <- SpatialPointsDataFrame(coords = lonlat, data = sub.dta,\n                                      proj4string = CRS(\"+proj=longlat +datum=WGS84 +ellps=WGS84\"))\n  land.mask <- readOGR(\"data/countries.geojson\", \"OGRGeoJSON\")\n  p <- spplot(full.spdf, zcol=variable, colorkey=FALSE, cex=0.25,\n              cuts=c(0,1),\n              col.regions=c(colors()[c(81)]),\n              xlim=c(-180,180),\n              ylim=c(-60,90),\n              key=list(lines=TRUE, col=\"transparent\"),\n              pch=5,\n              main=list(label=title,cex=0.5),\n              sp.layout = list(list(land.mask, fill=\"grey\", first=TRUE)))\n  graphics.off()\n  print(dev.list())\n  png(outpath,\n      width = 6, \n      height = 4, \n      units = 'in', \n      res = 300)\n  print(p)\n  dev.off()\n  \n  #Pre-balance plot - propensity score and four key variables (first four in list taken otherwise; prefix_prebalance.html)\n  #Stargazer table for propensity linear model (prefix_propensityModel.html)\n  #Post-balance plot - propensity score and four key variables (first four in list taken otherwise; prefix_postbalance.html)\n  #Stargazer table of balance statistics (prefix_balancestats.html)\n  #Causal Tree results (prefix_ct.png)\n  #Stargazer of linear model using matched cases and interactions identified in Causal Tree (prefix_geoMath.html)\n  #Map of predicted results from Causal Tree (prefix_prediction.png)\n  #CSV of predicted results from Causal Tree (prefix_prediction.csv)\n  #Random Forest results (prefix_rf.csv)\n  #Figure of most important variables in RF (prefix_purity.png)\n  #Map of uncertainty (\"% of observations within 1 standard deviation of the mean\") from RF (prefix_rfUnc.png)\n  print (\"Hello.\")\n}\n",
    "created" : 1480701041242.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1873645068",
    "id" : "149ABA0E",
    "lastKnownWriteTime" : 1480704105,
    "last_content_update" : 1480704105899,
    "path" : "~/Desktop/Github/GEF_MFA/generalized/io.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}